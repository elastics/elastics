<!DOCTYPE html>
<html>
  <head>
    <link href='/elastics/assets/global-74df1a51e3d7075c146b619ddfd07904.css' rel='stylesheet' type='text/css' />
<script src='/elastics/assets/global-aacc71e3a462796a62993fb5a8b696a3.js' type='text/javascript'></script>
<title>Elastics - How to migrate from Flex 0.x</title>
    <meta charset="UTF-8" />
    <script type="text/javascript">
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
      
      ga('create', 'UA-42574355-3', 'elasticston
      .github.io');
      ga('send', 'pageview');
    </script>
  </head>
  <body>
    <div id="page-nav" class="nocontent">
      <ul id="nav-menu" class="menu_h_list"><li><a href="#" class="isLabel">elastics</a><ul><li><a href="/elastics/doc/1-elastics/1-Overview.html">Elastics Overview</a></li><li><a href="/elastics/doc/1-elastics/2-Usage-Overview.html">Usage Overview</a></li><li><a href="/elastics/doc/1-elastics/3-Configuration.html">Configuration</a></li><li><a href="/elastics/doc/1-elastics/4-Rake-Tasks.html">Rake Tasks</a></li></ul></li><li><a href="#" class="isLabel">elastics-client</a><ul><li><a href="/elastics/doc/2-elastics-client/1-Overview.html">Overview</a></li><li><a href="/elastics/doc/2-elastics-client/2-API-Methods.html">API Methods</a></li><li><a href="#" class="isLabel">Templating</a><div class="arrow right"></div><ul><li><a href="/elastics/doc/2-elastics-client/3-Templating/1-Templates.html">Templates</a></li><li><a href="/elastics/doc/2-elastics-client/3-Templating/2-Sources.html">Template Sources</a></li><li><a href="/elastics/doc/2-elastics-client/3-Templating/3-Tags.html">Tags</a></li><li><a href="/elastics/doc/2-elastics-client/3-Templating/4-Variables.html">Variables</a></li><li><a href="/elastics/doc/2-elastics-client/3-Templating/5-Interpolation.html">Interpolation</a></li><li><a href="/elastics/doc/2-elastics-client/3-Templating/6-Partials.html">Partial Templates</a></li></ul></li><li><a href="/elastics/doc/2-elastics-client/4-Result-Extenders.html">Result Extenders</a></li><li><a href="/elastics/doc/2-elastics-client/5-Self-Documentation.html">Self Documentation</a></li><li><a href="/elastics/doc/2-elastics-client/6-Utility-Methods.html">Utility Methods</a></li></ul></li><li><a href="#" class="isLabel">elastics-scopes</a><ul><li><a href="/elastics/doc/3-elastics-scopes/1-Overview.html">Overview</a></li><li><a href="/elastics/doc/3-elastics-scopes/2-Scopes.html">Scopes</a></li></ul></li><li><a href="#" class="isLabel">elastics-models</a><ul><li><a href="/elastics/doc/4-elastics-models/1-Overview.html">Overview</a></li><li><a href="/elastics/doc/4-elastics-models/2-ActiveRecord-And-Mongoid-Integration.html">ActiveRecord And Mongoid Integration</a></li><li><a href="/elastics/doc/4-elastics-models/3-ActiveModel-Integration.html">ActiveModel Integration</a></li><li><a href="#" class="isLabel">Modules</a><div class="arrow right"></div><ul><li><a href="/elastics/doc/4-elastics-models/4-Modules/1-Elastics::ModelSyncer.html">Elastics::ModelSyncer</a></li><li><a href="/elastics/doc/4-elastics-models/4-Modules/2-Elastics::ModelIndexer.html">Elastics::ModelIndexer</a></li><li><a href="/elastics/doc/4-elastics-models/4-Modules/3-Elastics::ActiveModel.html">Elastics::ActiveModel</a></li></ul></li><li><a href="/elastics/doc/4-elastics-models/5-Result-Extenders.html">Result Extenders</a></li></ul></li><li><a href="#" class="isLabel">elastics-rails</a><ul><li><a href="/elastics/doc/5-elastics-rails/1-Overview.html">Overview</a></li><li><a href="/elastics/doc/5-elastics-rails/2-Result-Extenders.html">Result Extenders</a></li></ul></li><li><a href="#" class="isLabel">elastics-admin</a><ul><li><a href="/elastics/doc/6-elastics-admin/1-Binary.html">Binary</a></li><li><a href="/elastics/doc/6-elastics-admin/2-Live-Reindex.html">Live Reindex</a></li></ul></li><li><a href="#" class="isLabel">tutorials</a><ul><li><a href="/elastics/doc/7-tutorials/1-Elastics-vs-Tire.html">Why you should use Elastics rather than Tire</a></li><li><a href="/elastics/doc/7-tutorials/2-Migrate-from-0.x.html">How to migrate from Flex 0.x</a></li><li><a href="/elastics/doc/7-tutorials/3-Index-and-Search-your-Models.html">Index and Search your Models</a></li><li><a href="/elastics/doc/7-tutorials/4-Index-and-Search-External-Data.html">Index and Search External Data</a></li></ul></li></ul>
      <div id="google-search">
        <script type="text/javascript">
          (function() {
            var cx = '001168365143071728136:w4opkcwdl3y';
            var gcse = document.createElement('script');
            gcse.type = 'text/javascript';
            gcse.async = true;
            gcse.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') +
                '//www.google.com/cse/cse.js?cx=' + cx;
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(gcse, s);
          })();
        </script>
        <gcse:search>&nbsp;</gcse:search>
      </div>
    </div>
    <div id="page-toc">
      <div id="logo">
        <img src="/elastics/images/elastics-logo-200.png" />
      </div>
    </div>
    <div id="content">
      <a id="badge" href="https://badge.fury.io/rb/elastics-client"><img src="https://badge.fury.io/rb/elastics-client.png" /></a>
      <div class="breadcrumb nocontent">
        <span><a href="/elastics/doc">Elastics</a></span> &gt; <span><a href="/elastics/doc/7-tutorials">tutorials</a></span> &gt; <span>How to migrate from Flex 0.x</span>
      </div>
      <h1 id="how-to-migrate-from-flex-0x">How to migrate from Flex 0.x</h1>

<p>Elastics 1.x has changed quite a lot from Flex version 0.x but you need just to rename a few things in order to upgrade it. You should be able to do it in a couple of minutes with the help of the <code>elastics-legacy</code> gem and just a few search and replace.  If you miss any change, Elastics will work anyway, but will emit a deprecation warning, so keep an eye on the log.</p>

<h2 id="changes">Changes</h2>

<h3 id="gem-changes">1. Gem changes</h3>

<h4 id="rails-apps">Rails Apps</h4>

<p>You have to change <code>gem 'flex', :require =&gt; 'flex/rails'</code> to simply <code>gem 'elastics-rails'</code> in your <code>Gemfile</code>. Then add <code>elastics-legacy</code> gem to your <code>Gemfile</code>. It will make it work almost as it is and it will allow a smoot migration. Run a <code>bundle install</code> and your app should be able to start. Then it will emit the deprecation warnings for the other changes in the log.</p>

<h4 id="non-rails-apps">Non Rails Apps</h4>

<p>If you used model related functionality, you will be required to load the <code>elastics-models</code> gem that is now separated by the <code>elastics-client</code> core gem. You should require the <code>elastics-legacy</code> gem. It will make it work almost as it is and it will allow a smoot migration.</p>

<h3 id="configuration-renaming">2. Configuration Renaming</h3>

<p><code>base_uri</code> &gt; <code>http_client.base_uri</code></p>

<p><code>http_client_options</code> &gt; <code>http_client.options</code></p>

<p><code>raise_proc</code> &gt; <code>http_client.raise_proc</code></p>

<p><code>logger.color</code> &gt; <code>ansi</code></p>

<h3 id="special-variables">3. Special Variables</h3>

<p><code>vars[:size]</code> is not a special variable anymore, so it will not be automatically converted to the <code>vars[:params][:size]</code> param anymore. You must set it as a standard param: <code>:params =&gt; {:size =&gt; size}</code>.</p>

<blockquote>
  <p>Elastics will not emit any warning if you still use the old <code>vars[:size]</code> variable with the intention to change the <code>vars[:params][:size]</code> param: it will just not set the param. If you used the <code>&lt;&lt;size&gt;&gt;</code> tag in any template it will work as long as a <code>:size</code> variable is set. Remember that tags can now refer to nested variables, so you could refer to the <code>vars[:params][:size]</code> param in any template with <code>&lt;&lt;params.size&gt;&gt;</code>.</p>
</blockquote>

<h3 id="method-renaming">4. Method Renaming</h3>

<p><code>add</code> &gt; <code>deep_merge!</code> for all variables receivers</p>

<p><code>info</code> &gt; <code>doc</code> to print the self documentation (e.g. <code>Elastics.doc</code>, <code>YourClass.elastics.doc</code> (see <a href="/elastics/doc/2-elastics-client/5-Self-Documentation.html">Self Documentation</a>))</p>

<h4 id="bulk-support">Bulk Support</h4>

<p><code>Flex.bulk(:lines =&gt; lines_bulk_string)</code> &gt; <code>Elastics.post_bulk_string(:bulk_string =&gt; lines_bulk_string)</code></p>

<p><code>Flex.process_bulk(:collection =&gt; collection)</code> &gt; <code>Elastics.post_bulk_collection(collection, options)</code></p>

<p><code>Flex.import_collection</code> &gt; <code>Elastics.post_bulk_collection</code></p>

<p><code>Flex.delete_collection(collection)</code> &gt; <code>Elastics.post_bulk_collection(collection, :action =&gt; "delete")</code></p>

<h3 id="modules-renaming">5. Modules Renaming</h3>

<p><code>Flex::Loader</code> &gt; <code>Elastics::Templates</code></p>

<p><code>Flex::Model</code> &gt; <code>Elastics::ModelIndexer</code></p>

<p><code>Flex::RelatedModel</code> &gt; <code>Elastics::ModelSyncer</code></p>

<h3 id="rake-tasks-renaming">6. Rake Tasks Renaming</h3>

<blockquote>
  <p><strong>Notice</strong>: The following rake tasks have been renamed and are not available, so please, change their name acordingly. Besides some ENV variable used for other tasks, may also have been renamed (see <a href="/elastics/doc/1-elastics/4-Rake-Tasks.html">Rake Tasks</a>)</p>
</blockquote>

<p><code>flex:create_indices</code> &gt; <code>elastics:index:create</code></p>

<p><code>flex:delete_indices</code> &gt; <code>elastics:index:delete</code></p>

<h3 id="flex--elastics">7. flex &gt; elastics</h3>

<p>Search and replace in all your code <code>'flex'</code> for <code>'elastics'</code>. You must preserve the case so  for example <code>'Flex'</code> will be replaced by <code>'Elastics'</code> and <code>'flex_indexable?'</code> will be replaced by <code>'elastics_indexable?'</code> etc.</p>

<p>Rename also the <code>'flex'</code> dir to <code>'elastics'</code> and the files <code>'flex.yml'</code> and <code>'flex.rb'</code> to <code>'elastics.yml'</code> and <code>'elastics.rb'</code>.</p>

<h2 id="additions">Additions</h2>

<p>You may want to check the new documentation in order to take advantage of the new features of the gems. For example, you may want to add <code>Elastics::Scopes</code> to some of your classes, or you may want to use the new <code>elastics-admin</code> binary and tasks, or live-reindexing your code/index changes, or fine-tuning the configuration of the new elastics logger etc. (see <a href="/elastics/doc/1-elastics/1-Overview.html">Elastics Overview</a> and <a href="/elastics/doc/1-elastics/2-Usage-Overview.html">Usage Overview</a>)</p>

<br />
      <div class="breadcrumb nocontent">
        <span><a href="/elastics/doc">Elastics</a></span> &gt; <span><a href="/elastics/doc/7-tutorials">tutorials</a></span> &gt; <span>How to migrate from Flex 0.x</span>
      </div>
    </div>
    <div id="footer" class="nocontent">
      Copyright &copy; 2012-2013 by <a href="mailto://dd.nexus@gmail.com">Domizio Demichelis</a> &mdash; Sponsored by <a href="http://www.escalatemedia.com">Escalate Media</a> and <a href="http://www.barquin.com">Barquin International</a>
    </div>
  </body>
</html>