<!DOCTYPE html>
<html>
  <head>
    <link href='/elastics/assets/global-74df1a51e3d7075c146b619ddfd07904.css' rel='stylesheet' type='text/css' />
<script src='/elastics/assets/global-aacc71e3a462796a62993fb5a8b696a3.js' type='text/javascript'></script>
<title>Elastics - elastics-models - Elastics::ModelIndexer</title>
    <meta charset="UTF-8" />
    <script type="text/javascript">
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
      
      ga('create', 'UA-42574355-3', 'elasticston
      .github.io');
      ga('send', 'pageview');
    </script>
  </head>
  <body>
    <div id="page-nav" class="nocontent">
      <ul id="nav-menu" class="menu_h_list"><li><a href="#" class="isLabel">elastics</a><ul><li><a href="/elastics/doc/1-elastics/1-Overview.html">Elastics Overview</a></li><li><a href="/elastics/doc/1-elastics/2-Usage-Overview.html">Usage Overview</a></li><li><a href="/elastics/doc/1-elastics/3-Configuration.html">Configuration</a></li><li><a href="/elastics/doc/1-elastics/4-Rake-Tasks.html">Rake Tasks</a></li></ul></li><li><a href="#" class="isLabel">elastics-client</a><ul><li><a href="/elastics/doc/2-elastics-client/1-Overview.html">Overview</a></li><li><a href="/elastics/doc/2-elastics-client/2-API-Methods.html">API Methods</a></li><li><a href="#" class="isLabel">Templating</a><div class="arrow right"></div><ul><li><a href="/elastics/doc/2-elastics-client/3-Templating/1-Templates.html">Templates</a></li><li><a href="/elastics/doc/2-elastics-client/3-Templating/2-Sources.html">Template Sources</a></li><li><a href="/elastics/doc/2-elastics-client/3-Templating/3-Tags.html">Tags</a></li><li><a href="/elastics/doc/2-elastics-client/3-Templating/4-Variables.html">Variables</a></li><li><a href="/elastics/doc/2-elastics-client/3-Templating/5-Interpolation.html">Interpolation</a></li><li><a href="/elastics/doc/2-elastics-client/3-Templating/6-Partials.html">Partial Templates</a></li></ul></li><li><a href="/elastics/doc/2-elastics-client/4-Result-Extenders.html">Result Extenders</a></li><li><a href="/elastics/doc/2-elastics-client/5-Self-Documentation.html">Self Documentation</a></li><li><a href="/elastics/doc/2-elastics-client/6-Utility-Methods.html">Utility Methods</a></li></ul></li><li><a href="#" class="isLabel">elastics-scopes</a><ul><li><a href="/elastics/doc/3-elastics-scopes/1-Overview.html">Overview</a></li><li><a href="/elastics/doc/3-elastics-scopes/2-Scopes.html">Scopes</a></li></ul></li><li><a href="#" class="isLabel">elastics-models</a><ul><li><a href="/elastics/doc/4-elastics-models/1-Overview.html">Overview</a></li><li><a href="/elastics/doc/4-elastics-models/2-ActiveRecord-And-Mongoid-Integration.html">ActiveRecord And Mongoid Integration</a></li><li><a href="/elastics/doc/4-elastics-models/3-ActiveModel-Integration.html">ActiveModel Integration</a></li><li><a href="#" class="isLabel">Modules</a><div class="arrow right"></div><ul><li><a href="/elastics/doc/4-elastics-models/4-Modules/1-Elastics::ModelSyncer.html">Elastics::ModelSyncer</a></li><li><a href="/elastics/doc/4-elastics-models/4-Modules/2-Elastics::ModelIndexer.html">Elastics::ModelIndexer</a></li><li><a href="/elastics/doc/4-elastics-models/4-Modules/3-Elastics::ActiveModel.html">Elastics::ActiveModel</a></li></ul></li><li><a href="/elastics/doc/4-elastics-models/5-Result-Extenders.html">Result Extenders</a></li></ul></li><li><a href="#" class="isLabel">elastics-rails</a><ul><li><a href="/elastics/doc/5-elastics-rails/1-Overview.html">Overview</a></li><li><a href="/elastics/doc/5-elastics-rails/2-Result-Extenders.html">Result Extenders</a></li></ul></li><li><a href="#" class="isLabel">elastics-admin</a><ul><li><a href="/elastics/doc/6-elastics-admin/1-Binary.html">Binary</a></li><li><a href="/elastics/doc/6-elastics-admin/2-Live-Reindex.html">Live Reindex</a></li></ul></li><li><a href="#" class="isLabel">tutorials</a><ul><li><a href="/elastics/doc/7-tutorials/1-Elastics-vs-Tire.html">Why you should use Elastics rather than Tire</a></li><li><a href="/elastics/doc/7-tutorials/2-Migrate-from-0.x.html">How to migrate from Flex 0.x</a></li><li><a href="/elastics/doc/7-tutorials/3-Index-and-Search-your-Models.html">Index and Search your Models</a></li><li><a href="/elastics/doc/7-tutorials/4-Index-and-Search-External-Data.html">Index and Search External Data</a></li></ul></li></ul>
      <div id="google-search">
        <script type="text/javascript">
          (function() {
            var cx = '001168365143071728136:w4opkcwdl3y';
            var gcse = document.createElement('script');
            gcse.type = 'text/javascript';
            gcse.async = true;
            gcse.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') +
                '//www.google.com/cse/cse.js?cx=' + cx;
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(gcse, s);
          })();
        </script>
        <gcse:search>&nbsp;</gcse:search>
      </div>
    </div>
    <div id="page-toc">
      <div id="logo">
        <img src="/elastics/images/elastics-logo-200.png" />
      </div>
    </div>
    <div id="content">
      <a id="badge" href="https://badge.fury.io/rb/elastics-models"><img src="https://badge.fury.io/rb/elastics-models.png" /></a>
      <div class="breadcrumb nocontent">
        <span><a href="/elastics/doc">Elastics</a></span> &gt; <span><a href="/elastics/doc/4-elastics-models">elastics-models</a></span> &gt; <span><a href="/elastics/doc/4-elastics-models/4-Modules">Modules</a></span> &gt; <span>Elastics::ModelIndexer</span>
      </div>
      <h1 id="elasticsmodelindexer">Elastics::ModelIndexer</h1>

<blockquote>
  <p><strong>Notice</strong>: The <code>Elastics::ModelIndexer</code> includes also <code>Elastics::ModelSyncer</code> (see <a href="/elastics/doc/4-elastics-models/4-Modules/1-Elastics::ModelSyncer.html">Elastics::ModelSyncer</a>)</p>
</blockquote>

<p>Elastics avoids polluting your models with many methods: indeed it adds just a few methods, all starting with the <code>elastics_</code> prefix to avoid confusion:</p>

<ul>
  <li><code>Model.elastics</code></li>
  <li><code>Model.elastics_in_batches</code></li>
  <li><code>record.elastics</code></li>
  <li><code>record.elastics_source</code></li>
  <li><code>record.elastics_indexable?</code></li>
</ul>

<p>Besides you can define a <code>Model.elastics_result</code> method in order to customize the results (see <a href="/elastics/doc/2-elastics-client/4-Result-Extenders.html#modelelastics_resultresult">Model.elastics_result</a>)</p>

<p>The <code>Model.elastics_in_batches</code> is used internally to import the records/documents of the model. It is defined for <code>ActiveRecord</code> and <code>Mongoid</code> models. You may want to override it if you want to import only a subset of the table/collection (for example if you need to do an incremental import/live-reindex based on a timestamp).</p>

<h2 id="class-methods">Class Methods</h2>

<table class="code-topics" id="indexer-class-methods" cellspacing="0" cellpadding="0">
  <tr>
    <td>
      <code>elastics</code>
    </td>
    <td><p>You access all the Elastics features included in your model through the <code>elastics</code> proxy object. It implements the methods to map your models to the elasticsearch index, define parent/child relationships and sync.</p>

    </td>
  </tr>
  <tr>
    <td>
      <code>elastics.index</code>
    </td>
    <td><p>By default the index used for all the models in your app is the <code>Elastics::Configuration.variables[:index]</code>. In a rails app that gets set before initializing the app (see <a href="/elastics/doc/1-elastics/3-Configuration.html">Configuration</a>). You can map your model to another index by explicitly setting it in your class.</p>

<div class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="n">elastics</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="s1">&#39;foo&#39;</span></code></pre></div>

    </td>
  </tr>
  <tr>
    <td>
      <code>elastics.type</code>
    </td>
    <td><p>By default the type used for your model is the full-underscored class name. For example <code>MyModel::SuperSpecial</code> will generate <code>my_model__super_special</code>. Notice the double underscore in place of the commonly used slash, which avoids url conflicts. You can map your model to another type by explicitly setting it in your class:</p>

<div class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="n">elastics</span><span class="o">.</span><span class="n">type</span> <span class="o">=</span> <span class="s1">&#39;bar&#39;</span></code></pre></div>

    </td>
  </tr>
  <tr>
    <td>
      <code>elastics.parent</code>
    </td>
    <td>
      <p>Defines elasticsearch parent/child relations (see <a href="/elastics/doc/4-elastics-models/2-ActiveRecord-And-Mongoid-Integration.html#indexing_records">Indexing Records</a>).</p>
      
    </td>
  </tr>
  <tr>
    <td>
      <code>elastics.sync(*synced)</code>
    </td>
    <td><p>Implemented by the <code>Elastics::ModelSyncer</code> module (see <a href="/elastics/doc/4-elastics-models/4-Modules/1-Elastics::ModelSyncer.html#elastics&lt;em&gt;sync&lt;/em&gt;&lt;em&gt;synced&lt;/em&gt;">elastics.sync</a>).</p>

    </td>
  </tr>
  <tr>
    <td>
      <code>elastics.synced</code>
    </td>
    <td><p>Implemented by the <code>Elastics::ModelSyncer</code> module (see <a href="/elastics/doc/4-elastics-models/4-Modules/1-Elastics::ModelSyncer.html#elastics_synced">elastics.synced</a>).</p>

    </td>
  </tr>
  <tr>
    <td>
      <code>elastics_result(result)</code>
    </td>
    <td>
      <p>Custom defined method (see <a href="/elastics/doc/2-elastics-client/4-Result-Extenders.html#modelelastics&lt;em&gt;resultresult">Model.elasticsresult</a>).</p>
      
    </td>
  </tr>
  <tr>
    <td>
      <code>self.elastics_in_batches(options, block)</code>
    </td>
    <td>
      <p>Custom defined method (see <a href="/elastics/doc/4-elastics-models/2-ActiveRecord-And-Mongoid-Integration.html#modelelastics&lt;em&gt;in&lt;/em&gt;batches">Model.elastics<em>in</em>batches</a>).</p>
      
    </td>
  </tr>
</table>

<h2 id="instance-methods">Instance Methods</h2>

<p>You usually don’t need to deal with this methods unless you sync manually or have very special needs.</p>

<table class="code-topics" id="indexer-instance-methods" cellspacing="0" cellpadding="0">
  <tr>
    <td>
      <code>elastics</code>
    </td>
    <td><p>The <code>elastics</code> instance object is mostly used internally, however you can access all the Elastics features included in your records through it. It implements the methods to manage the elasticsearch document related to your record.</p>

    </td>
  </tr>
  <tr>
    <td>
      <code>elastics.index</code>
    </td>
    <td>
      <p>The index for this record.</p>
      
    </td>
  </tr>
  <tr>
    <td>
      <code>elastics.type</code>
    </td>
    <td>
      <p>The document type for this record.</p>
      
    </td>
  </tr>
  <tr>
    <td>
      <code>elastics.store</code>
    </td>
    <td><p>Indexes the <code>elastics_source</code> of this record. It is used internally and you don&#39;t need to use this directly if you use <code>Model.elastics.sync</code> on this model.</p>

    </td>
  </tr>
  <tr>
    <td>
      <code>elastics.remove</code>
    </td>
    <td><p>Removes the elasticsearch document for this record. It is used internally and you don&#39;t need to use this directly if you use <code>Model.elastics.sync</code> on this model.</p>

    </td>
  </tr>
  <tr>
    <td>
      <code>elastics.sync</code>
    </td>
    <td><p>Implemented by the <code>Elastics::ModelSyncer</code> module (see <a href="/elastics/doc/4-elastics-models/4-Modules/1-Elastics::ModelSyncer.html#elasticsync">elastics.sync</a>).</p>

    </td>
  </tr>
  <tr>
    <td>
      <code>elastics.get</code>
    </td>
    <td>
      <p>Retrieves the elasticsearch document from the index. The result is extended as usual (see <a href="/elastics/doc/2-elastics-client/4-Result-Extenders.html">Elastics Extenders</a>, <a href="/elastics/doc/4-elastics-models/5-Result-Extenders.html">Elastics Model Extenders</a> and <a href="/elastics/doc/5-elastics-rails/2-Result-Extenders.html">Elastics Rails Extenders</a>). Mostly useful in the console to inspect the elasticsearch related document.</p>
      
<div class="highlight"><pre><code class="language-irb" data-lang="irb"><span class="gp">&gt;&gt; </span><span class="n">comment</span> <span class="o">=</span> <span class="no">Comment</span><span class="o">.</span><span class="n">first</span>
<span class="gp">&gt;&gt; </span><span class="n">comment</span><span class="o">.</span><span class="n">elastics</span><span class="o">.</span><span class="n">get</span>
<span class="go">=&gt; {&quot;_index&quot;=&gt;&quot;my_index&quot;, &quot;_type&quot;=&gt;&quot;review_comment&quot;,&quot;_id&quot;=&gt;&quot;4f15d2712c16bf4337000012&quot;, ... }</span></code></pre></div>

    </td>
  </tr>
  <tr>
    <td>
      <code>elastics_source</code>
    </td>
    <td>
      <p>(see <a href="/elastics/doc/4-elastics-models/2-ActiveRecord-And-Mongoid-Integration.html#indexing_records">Indexing Records</a>)</p>
      
    </td>
  </tr>
  <tr>
    <td>
      <code>elastics_indexable?</code>
    </td>
    <td>
      <p>(see <a href="/elastics/doc/4-elastics-models/2-ActiveRecord-And-Mongoid-Integration.html#indexing_fields">Indexing Fields</a>)</p>
      
    </td>
  </tr>
  <tr>
    <td>
      <code>elastics_action</code>
    </td>
    <td><p>Should return the elasticsearch action. Useful when you have some logic in your models to delete documents on import. Default <code>&#39;index&#39;</code>.</p>

    </td>
  </tr>
  <tr>
    <th colspan="2" id="overriding_elastics_metafields">
      Overriding Elastics Metafields
    </th>
  </tr>
  <tr>
    <td>
      <code>elastics_id</code>, <code>elastics_index</code>, <code>elastics_type</code>, <code>elastics_parent</code>, <code>elastics_routing</code>
    </td>
    <td><p><strong>Use only if you know what you are doing!</strong></p>

<blockquote>
<p>You define any of this methods in your model, if you want to override the <code>elastics.id</code>, <code>elastics.index</code>, <code>elastics.type</code>, <code>elastics.parent</code> and/or <code>elastics.routing</code> generation.</p>
</blockquote>

<p>The <code>elastics_index</code> should be used if you want to implement dynamic indices in your model.</p>

    </td>
  </tr>
</table>

<br />
      <div class="breadcrumb nocontent">
        <span><a href="/elastics/doc">Elastics</a></span> &gt; <span><a href="/elastics/doc/4-elastics-models">elastics-models</a></span> &gt; <span><a href="/elastics/doc/4-elastics-models/4-Modules">Modules</a></span> &gt; <span>Elastics::ModelIndexer</span>
      </div>
    </div>
    <div id="footer" class="nocontent">
      Copyright &copy; 2012-2013 by <a href="mailto://dd.nexus@gmail.com">Domizio Demichelis</a> &mdash; Sponsored by <a href="http://www.escalatemedia.com">Escalate Media</a> and <a href="http://www.barquin.com">Barquin International</a>
    </div>
  </body>
</html>